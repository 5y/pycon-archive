
<!DOCTYPE html>
<html lang="en-us">
    
<!-- Mirrored from us.pycon.org/2012/schedule/presentation/89/ by HTTrack Website Copier/3.x [XR&CO'2010], Thu, 20 Jun 2013 15:33:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
<head>
        <meta charset="utf-8" />
        <link href="/2012/site_media/static/img/favicon.ico" rel="shortcut icon" />
        <title>PyCon US 2012 Presentation: 14. preshrunk-cotton: Windows Help Files for Lazy People</title>
        <!--  hack to make IE able to apply CSS to elements that it doesn't usually know about. See http://code.google.com/p/html5shim/ -->
        <!--[if lt IE 9]>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        
        <link rel="stylesheet" href="/2012/site_media/static/pinax/css/tabs.css" />
        <link rel="stylesheet" href="/2012/site_media/static/css/facebox.css" />
        <link href="https://fonts.googleapis.com/css?family=Droid+Sans+Mono" rel="stylesheet" type="text/css">
        <link href="/2012/site_media/static/markitup/skins/simple/style.css" type="text/css" media="screen" rel="stylesheet" />
<link href="/2012/site_media/static/markitup/sets/markdown-custom/style.css" type="text/css" media="screen" rel="stylesheet" />

        
    <!-- Framework CSS -->
<link rel="stylesheet" href="/2012/site_media/static/css/blueprint/grid.css" media="screen, projection" />
<link rel="stylesheet" href="/2012/site_media/static/css/blueprint/print.css" media="print" />
<!--[if lt IE 8]>
<link rel="stylesheet" href="/2012/site_media/static/css/blueprint/ie.css" media="screen, projection" />
<![endif]-->

        
    <link rel="stylesheet" href="/2012/site_media/static/css/reset.css" />
    <link rel="stylesheet" href="/2012/site_media/static/css/pycon.css" />
    <link rel="stylesheet" href="/2012/site_media/static/css/site_tabs.css" />
    <link rel="stylesheet" href="/2012/site_media/static/uni_form/uni-form.css" />
    <link rel="alternate" type="application/atom+xml" href="/2012/feed/general/" title="blog feed"/>
    
    <style>
        a.unbookmark {
            text-decoration: none;
            padding-left: 20px;
            background: url(/2011/site_media/static/img/star.png) no-repeat left;
        }
        a.bookmark {
            text-decoration: none;
            padding-left: 20px;
            background: url(/2011/site_media/static/img/star_unselected.png) no-repeat left;
        }
        div.slot {
            font-weight: bold;
        }
    </style>


    </head>

    <body class="full schedule " id="">
        <div class="wrapper">

            <div class="msg-container">
                
            </div>

            <header>
                <div class="container">
                    
                        <h1 id="logo"><a href="/2012/">PyCon 2012</a></h1>
                        
                        <div id="left_tabs"></div>
                        <div id="right_tabs"></div>
                        <div class="login">
    

<div class="account-bar">

    <a href="/2012/account/login/">Log in</a> or <a href="/2012/account/signup/">Sign Up</a>

</div>
<div class="clear"></div>

</div>
                        
    <nav id="main-nav">
        <ul>
            
                
                    <li id="tab_pycon-2013"><a href="/2013/" id="link-pycon-2013">PyCon 2013!</a></li>
                
            
                
                    <li id="tab_about" class="dropdown">
                        <a href="/2012/about/"
                              class="dropdown-toggle"
                              data-toggle="dropdown"
                              id="link-about">
                              About
                              <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            
                
                    <li id="tab_code-conduct"><a href="/2012/codeofconduct/" id="link-code-conduct">Code of Conduct</a></li>
                
            
                
                    <li id="tab_diversity"><a href="/2012/diversity/" id="link-diversity">Diversity</a></li>
                
            
                
                    <li id="tab_pycon-mobile-guide"><a href="http://guidebook.com/g/pycon2012/" id="link-pycon-mobile-guide">PyCon Mobile Guide</a></li>
                
            
                
                    <li id="tab_volunteers"><a href="/2012/community/volunteer/" id="link-volunteers">Volunteers</a></li>
                
            
                
                    <li id="tab_what-pycon"><a href="/2012/about/" id="link-what-pycon">What is Pycon?</a></li>
                
            
                
                    <li id="tab_join-conversation"><a href="https://pycon.disqus.com/" id="link-join-conversation">Join the Conversation</a></li>
                
            
                        </ul>
                    </li>
                
            
                
                    <li id="tab_blog"><a href="http://pycon.blogspot.com/" id="link-blog">Blog</a></li>
                
            
                
                    <li id="tab_schedule" class="dropdown">
                        <a href="/2012/schedule/"
                              class="dropdown-toggle"
                              data-toggle="dropdown"
                              id="link-schedule">
                              Schedule
                              <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            
                
                    <li id="tab_conference-schedule"><a href="/2012/schedule/" id="link-conference-schedule">Conference Schedule</a></li>
                
            
                
                    <li id="tab_keynote-speakers"><a href="/2012/keynotes/" id="link-keynote-speakers">Keynote Speakers</a></li>
                
            
                
                    <li id="tab_mobile-guide"><a href="http://guidebook.com/g/pycon2012/" id="link-mobile-guide">Mobile Guide</a></li>
                
            
                
                    <li id="tab_open-spaces"><a href="/2012/community/openspaces/" id="link-open-spaces">Open Spaces</a></li>
                
            
                
                    <li id="tab_posters"><a href="/2012/schedule/lists/posters/" id="link-posters">Posters</a></li>
                
            
                
                    <li id="tab_pycon-5k"><a href="/2012/5k/" id="link-pycon-5k">Pycon 5K</a></li>
                
            
                
                    <li id="tab_sprints"><a href="/2012/community/sprints/" id="link-sprints">Sprints</a></li>
                
            
                
                    <li id="tab_startup-row"><a href="/2012/community/startuprow/" id="link-startup-row">Startup Row</a></li>
                
            
                
                    <li id="tab_tutorials"><a href="/2012/schedule/tutorials/" id="link-tutorials">Tutorials</a></li>
                
            
                        </ul>
                    </li>
                
            
                
                    <li id="tab_sponsors" class="dropdown">
                        <a href="/2012/sponsors/"
                              class="dropdown-toggle"
                              data-toggle="dropdown"
                              id="link-sponsors">
                              Sponsors
                              <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            
                
                    <li id="tab_about-pycon-sponsors"><a href="/2012/sponsors/" id="link-about-pycon-sponsors">About Pycon Sponsors</a></li>
                
            
                
                    <li id="tab_jobs-fair"><a href="/2012/sponsors/jobs/" id="link-jobs-fair">Jobs Fair</a></li>
                
            
                
                    <li id="tab_sponsor-prospectus"><a href="/2012/sponsors/prospectus/" id="link-sponsor-prospectus">Sponsor Prospectus</a></li>
                
            
                
                    <li id="tab_sponsor-sign"><a href="/2012/sponsors/info/" id="link-sponsor-sign">Sponsor Sign Up</a></li>
                
            
                        </ul>
                    </li>
                
            
                
                    <li id="tab_venue" class="dropdown">
                        <a href="/2012/venue/"
                              class="dropdown-toggle"
                              data-toggle="dropdown"
                              id="link-venue">
                              Venue
                              <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            
                
                    <li id="tab_bars"><a href="/2012/venue/bars/" id="link-bars">Bars</a></li>
                
            
                
                    <li id="tab_directions-venue"><a href="/2012/venue/directions/" id="link-directions-venue">Directions to the Venue</a></li>
                
            
                
                    <li id="tab_explore-santa-clara"><a href="/2012/venue/explore/" id="link-explore-santa-clara">Explore Santa Clara</a></li>
                
            
                
                    <li id="tab_getting-around-santa-clara"><a href="/2012/venue/getting-around/" id="link-getting-around-santa-clara">Getting Around Santa Clara </a></li>
                
            
                
                    <li id="tab_restaurants"><a href="/2012/venue/restaurants/" id="link-restaurants">Restaurants</a></li>
                
            
                
                    <li id="tab_needs-share-room"><a href="/2012/community/roomsharing/" id="link-needs-share-room">Room Sharing</a></li>
                
            
                
                    <li id="tab_shopping"><a href="/2012/venue/shopping/" id="link-shopping">Shopping</a></li>
                
            
                
                    <li id="tab_traveling-santa-clara"><a href="/2012/venue/traveling/" id="link-traveling-santa-clara">Traveling</a></li>
                
            
                
                    <li id="tab_weather"><a href="/2012/venue/weather/" id="link-weather">Weather</a></li>
                
            
                        </ul>
                    </li>
                
            
        </ul>
    </nav>

                        
                    
                </div>
            </header>

            <section id="subnav">
                <div class="container">
                    

                </div>
            </section>

            
                
                <section id="body">
                    <div class="container">

                        
    
    
    <h1>14. preshrunk-cotton: Windows Help Files for Lazy People</h1>

    <div class="badges">
        
    </div>

    

    <div class="speakers">
        
            <a href="/2012/speaker/profile/55/">Jeffrey Armstrong</a>
        
    </div>
    
    <div class="badges">
        
        <div class="clear"></div>
    </div>

    <dl class="inline mod">
        <dt>Type:</dt>
        <dd>Poster</dd>

        <dt>Audience level:</dt>
        <dd>Novice</dd>

        <dt>Category:</dt>
        <dd>Documentation</dd>
    </dl>
    
    
        <div class="slot">March 11th 8:05 a.m. &ndash; 8:10 a.m.</div>
    

    <hr />

    <h3>Description</h3>

    <div class="description">Generating a Compiled HTML Help (CHM) file is often necessary when distributing applications on Microsoft Windows platforms.  However, many developers may dislike authoring HTML and/or cannot use Microsoft’s help tools.  preshrunk-cotton streamlines the creation of CHM files by allowing the author to quickly write documentation in Textile markup and build the help file on almost any platform.</div>
    
    <hr />

    <h3>Abstract</h3>
    
    <div class="abstract"><p>When distributing applications for the Microsoft Windows platform, documentation is often included in Compiled HTML Help form, one of Microsoft’s native help formats.  Traditionally Compiled HTML Help, or CHM, files are normally constructed from HTML files using Microsoft’s tools or a variety of wrappers that employ these tools. This workflow is sometimes suboptimal for many developers that are using non-Windows build servers and/or want to avoid authoring HTML directly.</p>
<p>The package to be presented, <em>preshrunk-cotton</em>, is meant to solve two problems simultaneously: eliminate the need to directly author HTML files and allow building CHM files on any platform.  To avoid HTML authoring, <em>preshrunk-cotton</em> uses the Textile markup language to significantly accelerate the process of actually writing documentation.  Each “page” of help is represented by a separate file in a directory structure written using Textile.  The directory structure itself is then used to generate the organizational tree of the resultant CHM file.  Images and any other files not written in Textile (including HTML files) are simply left as is, allowing for their inclusion in the CHM file.</p>
<p>Building CHM files on a variety of platforms introduces an interesting issue.  Normally, Microsoft’s HTML Help Workshop is used to compile CHM files from HTML and supporting files.  However, using the Microsoft tools implies that one has the ability to execute said tools on their build system, which is often not the case.  An alternative compiler from the Free Pascal project, <em>chmcmd</em>, also has the ability to build CHM files without the need for any Microsoft tools.  The tool was originally created in support of compiling Free Pascal’s documentation, but the small utility has one extraordinary implication: the <em>chmcmd</em> utility allows for the creation of CHM files on any platform supported by FreePascal.</p>
<p>The <em>chmcmd</em> utility is not particularly user-friendly, requiring some cryptic XML files to be present for the purposes of constructing the resultant CHM file.  <em>preshrunk-cotton</em> is able to automatically generate all the necessary input files and instructions required by <em>chmcmd</em>.  By traversing the directory structure of input files and examining some simple informational files, <em>preshrunk-cotton</em> can construct the proper XML for <em>chmcmd</em>, generate an educated guess at help file index entries, execute the utility, and return the name and location of a valid CHM file.</p>
<p>The biggest strength of preshrunk-cotton is its ability to be integrated with existing build tools.  A command line script is available to accept a directory tree containing textile, HTML, and other supporting files and generate a CHM file, allowing simple integration with makefile-based build systems and similar tools.  Alternatively, if a build system is based on Python, <em>preshrunk-cotton</em> can be more directly integrated.</p>
<p>This package was originally written to support a proprietary commercial software package, and it continues to be used  to construct documentation for said product.  However, the package would benefit from additional community involvement, and it may prove helpful to a significant number of developers distributing software for the Windows platform.<br/>
</p>
<p>More information:</p>
<p><em>preshrunk-cotton</em>: <a href="http://code.google.com/p/preshrunk-cotton/">http://code.google.com/p/preshrunk-cotton/</a></p>
<p>Free Pascal’s CHM implementation: <a href="http://wiki.freepascal.org/chm">http://wiki.freepascal.org/chm</a></p></div>



                    </div>

                </section>
            
            <div class="push"></div>
        </div>

        <footer>
            <div class="container">
    <p>
        PyCon US 2012 is a production of the <a href="http://python.org/psf/">Python Software Foundation</a>.
    <br />
        Site built by <a href="http://eldarion.com">Eldarion</a> using <a href="http://djangoproject.com">Django</a> and <a href="http://pinaxproject.com">Pinax</a>. Hosting provided by <a href="http://gondor.io">Gondor</a>.
    <br />
        Questions? Comments? Contact <a href="mailto:pycon-organizers@python.org">pycon-organizers@python.org</a>
    </p>
</div>
        </footer>

        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
        <script src="/2012/site_media/static/js/base.js" type="text/javascript"></script>
        <script src="/2012/site_media/static/uni_form/uni-form.jquery.js" type="text/javascript"></script>
        <script type="text/javascript" src="/2012/site_media/static/markitup/jquery.markitup.js"></script>
        <script type="text/javascript" src="/2012/site_media/static/markitup/sets/markdown-custom/set.js"></script>
        <script src="/2012/site_media/static/js/facebox.js" type="text/javascript"></script>
<script type="text/javascript">
    jQuery(document).ready(function($) {
        $('a[rel*=facebox]').facebox({
            loadingImage: '/2012/site_media/static/img/facebox/loading.gif',
            closeImage: '/2012/site_media/static/img/facebox/closelabel.png'
        });
        $(document).bind('reveal.facebox', function() {
            $("form.in_facebox").submit(function() {
                form = this;
                jQuery.facebox(function($) {
                    fields = jQuery(form).find("input[type='text']").filter(":enabled");
                    params = {}
                    fields.each(function() {
                        params[this.name] = this.value;
                    });
                    jQuery.post(form.action, params,
                        function(data, textStatus) {
                            jQuery.facebox(data);
                        }
                    );
                });
                return false;
            });
        });
        $(document).bind('close.facebox', function() {
           location.reload();
          });
     });
</script>
        <script type="text/javascript" charset="utf-8">
            $(document).ajaxSend(function(event, xhr, settings) {
                function getCookie(name) {
                    var cookieValue = null;
                    if (document.cookie && document.cookie != '') {
                        var cookies = document.cookie.split(';');
                        for (var i = 0; i < cookies.length; i++) {
                            var cookie = jQuery.trim(cookies[i]);
                            // Does this cookie string begin with the name we want?
                            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                break;
                            }
                        }
                    }
                    return cookieValue;
                }
                function sameOrigin(url) {
                    // url could be relative or scheme relative or absolute
                    var host = document.location.host; // host + port
                    var protocol = document.location.protocol;
                    var sr_origin = '//' + host;
                    var origin = protocol + sr_origin;
                    // Allow absolute or scheme relative URLs to same origin
                    return (url == origin || url.slice(0, origin.length + 1) == origin + '/') ||
                        (url == sr_origin || url.slice(0, sr_origin.length + 1) == sr_origin + '/') ||
                        // or any other URL that isn't scheme relative or absolute i.e relative.
                        !(/^(\/\/|http:|https:).*/.test(url));
                }
                function safeMethod(method) {
                    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
                }

                if (!safeMethod(settings.type) && sameOrigin(settings.url)) {
                    xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
                }
            });
        </script>
        
        <script type="text/javascript">
            $(document).ready(function($) {
                $("a.boxes-edit-link").click(function() {
                    $.facebox.settings.loadingImage = "/site_media/static/img/loading.gif";
                    $.facebox.settings.closeImage = "/site_media/static/img/closelabel.png";
                    $(document).bind("beforeReveal.facebox", function() {
                        $("#facebox .content").css("width", "600px");
                    });
                    var editable = this;
                    $(document).bind("reveal.facebox", function() {
                        $("#edit_form").submit(function() {
                            $.post(editable.href, $(this).serialize(), function(data) {
                                $(document).trigger("close.facebox");
                                $(editable).load(data);
                                $(document).unbind("reveal.facebox");
                            });
                            return false;
                        });
                    });
                    $.facebox({ajax: this.href});
                    return false;
                });
            });
        </script>
        
        <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-2401894-29']);
    _gaq.push(['_trackPageview']);
    _gaq.push(['_trackPageLoadTime']);
    // _gaq.push(['_setCustomVar', 1, 'Authentication Type', ut, 2]);
    
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>
        
        
    <script type="text/javascript" charset="utf-8">
      $(function(){
          $("#id_email").focus();
          if(('ul#messages').length > 0) {
              setTimeout(function() {
                  $('ul#messages').fadeOut(3000);
              }, 2000 );
          }
      });
    </script>
    
    <script type="text/javascript">
        $(document).ready(function() {
            $("a.bookmark").live("click", function() {
                aElem = $(this);
                $.ajax({
                    type: "POST",
                    url: this.href,
                    data: "action=add;csrfmiddlewaretoken=e867c258e1a91e5d72cf745f26f82408",
                    success: function() {
                        aElem.text("unbookmark");
                        aElem.removeClass("bookmark");
                        aElem.addClass("unbookmark");
                    },
                    error: function(xhr, options, error) {
                        alert(xhr.status);
                    }
                });
                return false;
            });
            $("a.unbookmark").live("click", function() {
                aElem = $(this);
                $.ajax({
                    type: "POST",
                    url: this.href,
                    data: "action=delete;csrfmiddlewaretoken=e867c258e1a91e5d72cf745f26f82408",
                    success: function(response) {
                        aElem.text("bookmark");
                        aElem.removeClass("unbookmark");
                        aElem.addClass("bookmark");
                    },
                    error: function(xhr, options, error) {
                        alert(xhr.status);
                    }
                });
                return false;
            });
        });
    </script>


    </body>

<!-- Mirrored from us.pycon.org/2012/schedule/presentation/89/ by HTTrack Website Copier/3.x [XR&CO'2010], Thu, 20 Jun 2013 15:33:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->
</html>
